
=head2 How to wipe a database

Here are a few possible ways to wipe an existing database:

=over 5

=item 1.

Iterate through the database, deleting each key/value pair in turn. A
useful shortcut is to assign an empty list to the tied variable, like
this:

    %h = ()

=item 2.

Delete the database file and create it again.

    unlink $file ;
    tie %x, 'DB_File', $file, ...


=item 3.

Specify the O_TRUNC flag when opening the existing database.
 
    tie %h, "DB_File", $filename, O_RDWR||O_CREAT|O_TRUNC, 0640, $DB_HASH
        or die "Cannot open file '$filename': $!\n";
 

=back

Of the methods shown above the first is I<by far> the slowest. It will
also keep the database at the same size. On a Sun workstation, for
example, the final two options will result in a file about 32K.

Frederic Achard (fred@lovelace.infobiogen.fr) wrote:
: Is there an easy way to clear a DB_HASH (from DB_file)
: without actually deleting all key-value pairs or
: unlinking the file.
: Something like $X->clear would be nice.
: In case I have to implement this myself, any advice
: for a smart fast way to do that.
 
Specify the O_TRUNC flag when opening the database.
 
    tie %h, "DB_File", $filename, O_RDWR||O_CREAT|O_TRUNC, 0640, $DB_HASH
        or die "Cannot open file '$filename': $!\n";
 
 
You can also delete the contents of a database like this:
 
    %h = () ;
 
That will iterate through the database, deleting each key/value pair in
turn. There are two disadvantages of this method:
 
    1. it is *much* slower than O_TRUNC
    2. the database file won't get any smaller (the O_TRUNC method will
       shrink the database to the smallest it can get - about 32k on my
       Sun).
 
Paul

